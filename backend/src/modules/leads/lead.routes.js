// Мы импортируем библиотеку zod.
// zod нужен, чтобы проверять данные, которые присылает клиент (например из Postman или с формы).
// Синтаксис { z } означает: "взять именованный экспорт z из пакета 'zod'".
import {z} from 'zod';
// Мы импортируем модель Lead из файла lead.model.js.
// Модель — это "объект-класс" для работы с коллекцией leads в MongoDB.
// Мы будем делать Lead.create(), Lead.find(), Lead.findById() и т.д.
import {Lead} from './lead.model.js';

// -----------------------------
// ✅ СХЕМА ДЛЯ СОЗДАНИЯ ЛИДА
// -----------------------------

// Мы создаём схему для body запроса при создании лида.
// z.object({...}) означает: "ожидаем объект".
// Фигурные скобки {} в JS означают объект.
// Внутри — описание полей объекта.
const createLeadSchema = z.object({
    // Поле name: обязательно строка, минимум 1 символ.
    // z.string() — тип строка.
    // .min(1) — проверка на минимальную длину.
    name: z.string().min(1),
    // Поле email: строка, но НЕ обязательно.
    // .optional() означает: поле может отсутствовать вообще.
    email: z.string().optional(),
    // Поле phone: строка, тоже optional.
    phone: z.string().optional(),
    comment: z.string().optional(),
    source: z.string().optional(),
});

// -----------------------------
// ✅ СХЕМА ДЛЯ ОБНОВЛЕНИЯ ЛИДА
// -----------------------------

// Для обновления нам удобно сделать схему "partial".
// partial() означает: все поля становятся optional.
// То есть PATCH может прислать только { status: "..." } и это нормально.
const updateLeadSchema = createLeadSchema.partial();





